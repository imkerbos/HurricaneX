# 🌪 流量飓风（HurricaneX）

> 下一代基于 DPDK 的分布式 L7 高强度流量仿真与攻防验证平台

---

## 📖 项目简介

流量飓风是一款面向 CDN / WAF / 高防系统 / 负载均衡设备 的超高性能流量生成与攻防验证平台。

项目设计灵感来源于 dperf，并在其高性能 L4 架构基础上进行扩展与升级，构建面向 L7 场景的分布式攻防仿真系统。

相比传统 L4 压测工具，流量飓风专注于：

- 域名级 HTTP/HTTPS 测试
- TLS 握手压力模型
- CC 行为仿真
- 分布式节点池调度
- 超大规模并发连接模拟

目标构建一个真正用于防御验证与攻防实验的基础设施级平台。

---

## 🎯 设计目标

| 指标 | 目标值 | 备注 |
|------|--------|------|
| HTTP CPS | 待测试验证 | L7 层含协议解析开销，以实测为准 |
| HTTPS CPS | 待测试验证 | TLS 握手开销显著，需单独评估 |
| 吞吐能力 | 100–400 Gbps | 取决于硬件配置 |
| 单节点并发连接 | 1亿+ | 需配合 hugepage 内存规划 |
| 延迟精度 | 微秒级 | |
| 分布式扩展 | 横向扩展 | 多节点线性叠加 |
| 域名级压测 | 支持 | |
| TLS 握手压测 | 深度支持 | TLS 1.2 / 1.3 |

---

## 🧠 与 dperf 的关系

dperf 是优秀的 DPDK L4 性能测试工具，专注于：

- IP 级 TCP/UDP 压测
- 高性能 L4 CPS
- 网络协议栈性能验证

流量飓风在其思路基础上，扩展到：

| 能力 | dperf | 流量飓风 |
|------|--------|-----------|
| L4 TCP CPS | ✅ | ✅ |
| 域名级测试 | ❌ | ✅ |
| HTTP 语义控制 | ❌ | ✅ |
| TLS 1.3 压测 | ❌ | ✅ |
| CC 行为仿真 | ❌ | ✅ |
| 分布式节点池 | ❌ | ✅ |
| L7 攻防验证 | ❌ | ✅ |

流量飓风定位为：

> 面向 L7 攻防验证的下一代 DPDK 流量平台。

---

## 🏗 系统架构

```
                   控制平面
           （调度 / API / 指标聚合）
                        |
------------------------------------------------------
|              |              |                    |
节点1         节点2         节点3               节点N
(DPDK引擎)   (DPDK引擎)   (DPDK引擎)         (DPDK引擎)
                        |
                  目标系统
        (CDN / WAF / 高防 / 负载均衡)
```

---

## 🚀 核心能力

### 1️⃣ DPDK 高性能流量核心

- Kernel Bypass 架构
- 多队列 NIC 优化
- NUMA 亲和性优化
- 自定义 TCP 状态机
- 零拷贝内存池
- 微秒级调度

---

### 2️⃣ L7 协议仿真能力

- DNS 解析模块
- SNI 指定
- Host Header 自定义
- HTTP KeepAlive
- HTTP 短连接模式
- TLS 1.2 / 1.3 握手洪泛
- Header 随机化
- User-Agent 池
- Cookie 模拟
- HTTP 状态码统计

---

### 3️⃣ 分布式节点池

- 节点上线确认与调度分发
- 全局 CPS 控制
- 动态扩缩容
- 流量均衡分发
- Prometheus 指标输出
- 支持裸金属 / 云主机 / 混合云

---

## 🔬 典型应用场景

- CDN 高防能力验证
- WAF CC 拦截测试
- 云负载均衡容量验证
- 抗 DDoS 设备测试
- L7 攻防实验室环境验证
- 安全红蓝对抗演练

---

## ⚙ 技术栈

- DPDK
- C（流量核心）
- Rust / Go（控制平面）
- gRPC
- Prometheus
- eBPF（可观测扩展）
- YAML（统一配置格式）

---

## 📂 目录规划

```
HurricaneX/
│
├── cmd/                  # CLI 入口（hurricane, hurricane-ctl）
├── engine/               # DPDK 流量引擎核心
│   ├── tcp/              # 自定义 TCP 状态机
│   ├── http/             # HTTP 协议仿真
│   └── tls/              # TLS 握手引擎
├── scheduler/            # 分布式节点调度
├── metrics/              # Prometheus 指标采集与输出
├── configs/              # YAML 配置文件
├── preflight/            # 环境预检与依赖检测
└── docs/                 # 文档
```

---

## 🔍 环境预检（Preflight Check）

在启动前，HurricaneX 会自动执行环境预检，确认运行条件是否满足：

| 检测项 | 说明 |
|--------|------|
| DPDK 驱动 | 检测 igb_uio / vfio-pci 是否加载 |
| Hugepage | 检测 hugepage 分配状态及大小是否充足 |
| NIC 绑定 | 检测目标网卡是否已绑定到 DPDK 驱动 |
| CPU 亲和性 | 检测可用核心数及 NUMA 拓扑 |
| 内存容量 | 根据目标并发数评估内存是否充足 |
| 依赖库 | 检测 libdpdk、libnuma、OpenSSL 等依赖 |
| 内核参数 | 检测 iommu、isolcpus 等内核启动参数 |
| 权限 | 检测是否具有 root 或 CAP_NET_ADMIN 权限 |

预检不通过时将输出具体缺失项及修复建议，不会强行启动。

```bash
./hurricane preflight
```

---

## 🧪 示例

### 单节点

```bash
./hurricane \
  --mode https \
  --domain example.com \
  --cps 5000000 \
  --connections 100000000 \
  --duration 120
```

### 分布式

```bash
hurricane-ctl deploy --nodes 10
hurricane-ctl scale --cps 50000000
hurricane-ctl monitor
```

---

## ⚠ 合规与免责声明

本项目仅限以下用途：

- 经授权的安全测试与红蓝对抗演练
- CDN / WAF / 高防 / 负载均衡等防御系统的能力验证
- 实验室环境下的性能评估与压力测试

**使用限制：**

- 使用者必须在获得明确授权的目标环境中运行本工具
- 严禁将本工具用于未经授权的网络攻击或任何违反法律法规的行为
- 因使用本工具产生的一切法律责任由使用者自行承担
- 本项目作者及贡献者不对任何滥用行为承担责任

---

## 👨‍💻 作者

Kerbos  
DevOps / 高性能网络 / 安全攻防工程师
